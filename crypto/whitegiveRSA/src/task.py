from Crypto.Util.number import getPrime, isP    rime
from libnum import s2n
from random import randint
from secret import flag, hint

hint = s2n(hint)

P = getPrime(1024)

def whitegivePrime():
    n = 2
    ps = [2]
    while True:
        d = getPrime(randint(9, 11))
        ps.append(d)
        n = n * d
        if n + 1 > hint and isPrime(n + 1):
            break
    n += 1
    for g in range(2, ps[-1] ** 2 - 1):
        is_primitive_root = True
        for p in ps:
            if pow(g, (n - 1) // p, n) == 1:
                is_primitive_root = False
                break
        if is_primitive_root:
            break
    return n, g

def nextPrime(n):
    n += 2 if n & 1 else 1
    while not isPrime(n):
        n += 2
    return n
q, g = whitegivePrime()
print('g =', g)
#g = 6
print('q =', q)
#q = 307132275020853431035041222583514542784452982807697536232379897569768752688415827814985078862846915802928365390063791101634764810085800485658986523636105181016478997878827247582936331362418715733723293825693158579608202518233289849716623113759906142441477223591290084928130624179447239764554114333383186795119825995572856818269736491547416711529840464838419
c = pow(g, hint, q)
print('c =', c)
#c = 163931173441171130796011960845634179843969144480789202335625801624920837930007062044534891711541284083231332937201935623494570185147439809386193373572558353745744623269422679864759638636300479342016231022348853302438569688679541497547289063932279737287834051852332720435668943202238801630561766659318546438320313889211760172065698233522623594077661040299209

# you can check n2s(hint)~
next_q = nextPrime(hint)

q = next_q >> 60 << 60
Q = 1
while(isPrime(Q) != 1):
    Q = q + randint(0, 2 ** 60)
e = 65537
N = P * Q
print(N)
#N = 8342280319735095137719778778132457048000075937695604307266803357026189626939997941025405226456688089197939732572639455069633636090973727810610351109440219485323512844326587527537902908052026335734117887788275194743307342916399420786509630895837576285889216317465595362908568627422906698217561698958684401156180016647245819991284374035152219728846703718290271447674726357460689334574663279993850469547817982598061104030760648624706270146673296235401397960079637994746930068952023395710963080709649887815036292421730665273117748084472305690598216734931412856432104532422344105470437027863064450159943333120876010011137

c = pow(s2n(flag),e,N)
print(c)
#c = 3924629904664039131550703270584210474758319747208312598311891562794962012760374088514930598972391664041322909578278045547583710417032038996749692288673841527633530231516626336497864795180939900627743392978844475086445041485659248244547314710025216397798794227282075851255093566816382327084760980256054525420288948558333189670038565713427826935522581223805262687749295455367235978202247033133473395648996578895792389295075285624992008850545347772534517897678380500283010228827020405034977963841659794826042751356186424316863331058397178993420046081480540545852210743696505504761922289067686284068047357551456713637975
